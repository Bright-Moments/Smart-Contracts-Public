// SPDX-License-Identifier: MIT
/*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                             @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                             @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                                @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                                    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                                      @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                                         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                                           @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                      @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@      @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@           @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@             @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@              @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@              @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@             @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@           @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@      @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                      @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                                           @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                                         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                                      @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                                    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                                @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                             @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                             @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@*/
/**
 * @dev: @brougkr
 */
pragma solidity 0.8.19;
import {ERC20} from "@openzeppelin/contracts/token/ERC20/ERC20.sol";
import {IERC721} from "@openzeppelin/contracts/interfaces/IERC721.sol";
import {ReentrancyGuard} from "@openzeppelin/contracts/security/ReentrancyGuard.sol";
import {Ownable} from "@openzeppelin/contracts/access/Ownable.sol";
import {IBRT} from "./IBRT.sol";
contract CTZN is ERC20, ReentrancyGuard, Ownable
{
    event ContractsActiveStateChanged(address[] ContractAddresses, bool[] Values);
    event OwnerChanged(address OldOwner, address NewOwner);
    event ContractAddressesChanged(uint[] ProjectIDs, address[] ContractAddresses);
    event ContractNamesChanged(uint[] ProjectIDs, string[] Names);
    event CitizensDelegated(uint[][] TokenIDs, address Redeemer);
    event RewardRatesChanged(uint ProjectID, uint[] RewardIndexes, uint[] RewardRates);
    event RewardsDistributed(address Recipient, uint Amount);
    event ContractInstancesChanged(uint[] ProjectIDs, address[] ContractAddresses, string[] Names, bool[] ActiveStates);

    mapping(uint => BRTContract) public BRTContracts;
    mapping(uint => CitizenContract) public CitizenContracts;
    mapping(uint => address) public CitizenDelegation;
    mapping(address => bytes32) public Role;
    mapping(address => bool) public BRTContractActive;
    mapping(address => uint) public AddressDelegatedCitizens;

    /**
     * @dev Activated BRT Smart Contract
     */
    struct BRTContract
    {
        string Name;                // [0] - Name
        address ContractAddress;    // [1] - ContractAddress
    }

    /**
     * @dev CryptoCitizens
     */
    struct CitizenContract
    {
        string Name;                // [0] - Name
        uint StartingIndex;         // [1] - Starting TokenID
        uint EndingIndex;           // [2] - Ending TokenID
        uint FirstBlockTimestamp;   // [3] - First Block Timestamp
        address ContractAddress;    // [4] - ContractAddress
        bool Active;                // [5] - Active
    }

    constructor() ERC20("CTZN", "CTZN") 
    {
        BRTContracts[0] = BRTContract('CryptoCitizenLiveMint', address(0));
        BRTContracts[1] = BRTContract('Marketplace', address(0));
        BRTContracts[2] = BRTContract('BrightBundles', address(0));
        BRTContracts[3] = BRTContract('IRL', address(0));
        CitizenContracts[0] = CitizenContract('CryptoGalacticans', 0, 999, 31659986, 0xbDdE08BD57e5C9fD563eE7aC61618CB2ECdc0ce0, true);
        CitizenContracts[1] = CitizenContract('CryptoVenetians', 95000000, 95000999, 31657986, 0xa7d8d9ef8D8Ce8992Df33D8b8CF4Aebabd5bD270, true);
        CitizenContracts[2] = CitizenContract('CryptoNewYorkers', 189000000, 189000999, 31688986, 0xa7d8d9ef8D8Ce8992Df33D8b8CF4Aebabd5bD270, true);
        CitizenContracts[3] = CitizenContract('CryptoBerliners', 3000000, 3000999, 31656986, 0xbDdE08BD57e5C9fD563eE7aC61618CB2ECdc0ce0, true);
        CitizenContracts[4] = CitizenContract('CryptoLondoner', 4000000, 4000999, 31656986, 0xbDdE08BD57e5C9fD563eE7aC61618CB2ECdc0ce0, true);
        CitizenContracts[5] = CitizenContract('CryptoMexicas', 5000000, 5000999, 31656986, 0xbDdE08BD57e5C9fD563eE7aC61618CB2ECdc0ce0, true);
        CitizenContracts[6] = CitizenContract('CryptoTokyites', 6000000, 6000999, 0, 0xfcE8A5DA534fB7829a0880C76c9feDa48Abee02c, false);
        CitizenContracts[7] = CitizenContract('CryptoCitizen City #8', 7000000, 7000999, 0, 0xfcE8A5DA534fB7829a0880C76c9feDa48Abee02c, false);
        CitizenContracts[8] = CitizenContract('CryptoCitizen City #9', 8000000, 8000999, 0, 0xfcE8A5DA534fB7829a0880C76c9feDa48Abee02c, false);
        CitizenContracts[9] = CitizenContract('CryptoCitizen City #10', 9000000, 9000999, 0, 0xfcE8A5DA534fB7829a0880C76c9feDa48Abee02c, false);
    }

    /**
     * @dev Delegates Citizens For CTZN Multiplier
     */
    function DelegateCitizens(address Recipient, uint[][] calldata TokenIDs) public nonReentrant
    {
        for(uint CityIndex; CityIndex < TokenIDs.length; CityIndex++)
        {
            for(uint TokenID; TokenID < TokenIDs[CityIndex].length; TokenID++)
            {
                require(
                    TokenIDs[CityIndex][TokenID] >= CitizenContracts[CityIndex].StartingIndex 
                    && 
                    TokenIDs[CityIndex][TokenID] <= CitizenContracts[CityIndex].EndingIndex, 
                    "CTZN: Invalid TokenID For CityID"
                );
                require(
                    IERC721(CitizenContracts[CityIndex].ContractAddress).ownerOf(TokenIDs[CityIndex][TokenID])
                    == 
                    msg.sender,
                    "CTZN: User Does Not Own TokenID"
                );
                require(CitizenContracts[CityIndex].Active, "City Not Active Yet");
                if(CitizenDelegation[TokenIDs[CityIndex][TokenID]] != address(0))
                {
                    AddressDelegatedCitizens[CitizenDelegation[TokenIDs[CityIndex][TokenID]]]--;
                }
                AddressDelegatedCitizens[Recipient]++;
                CitizenDelegation[TokenIDs[CityIndex][TokenID]] = Recipient;
            }
        }
        emit CitizensDelegated(TokenIDs, Recipient);
    }

    /*-----------------*/
    /*  EXTERNAL CALL  */
    /*-----------------*/

    /**
     * @dev Mints $CTZN Rewards To User
     */
    function IncrementCTZN(address Recipient, uint Amount) external onlyBRTContract
    { 
        if(AddressDelegatedCitizens[Recipient] > 0)
        {
            uint NewAmount = (Amount * (AddressDelegatedCitizens[Recipient]));
            _mint(Recipient, NewAmount);
            emit RewardsDistributed(Recipient, NewAmount);                              
        }
        else
        {
            _mint(Recipient, Amount);
            emit RewardsDistributed(Recipient, Amount);                              
        }
    }

    /*---------------*/
    /*  PUBLIC VIEW  */
    /*---------------*/

    /**
     * @dev Returns Delegated Citizens
     */
    function ViewDelegatedCitizens(uint[][] calldata TokenIDs) public view returns(address[] memory)
    {
        address[] memory Delegates = new address[](TokenIDs.length);
        for(uint x; x < TokenIDs.length; x++)
        {
            for(uint y; y < TokenIDs[x].length; y++)
            {
                Delegates[x] = CitizenDelegation[TokenIDs[x][y]];
            }
        }
        return Delegates;
    }

    /*--------------*/
    /*  ONLY OWNER  */
    /*--------------*/

    /**
     * @dev Changes Contract Instances
     */
    function __ChangeContractInstances(
        uint[] calldata ProjectIDs, 
        address[] calldata ContractAddresses, 
        string[] calldata Names, 
        bool[] calldata ActiveStates
    ) external onlyOwner {
        for(uint x; x < ProjectIDs.length; x++)
        {
            if(BRTContracts[x].ContractAddress != address(0) && BRTContracts[x].ContractAddress != ContractAddresses[x])
            {
                BRTContractActive[BRTContracts[x].ContractAddress] = false;
            }
            BRTContracts[x].ContractAddress = ContractAddresses[x];
            BRTContracts[x].Name = Names[x];
            BRTContractActive[ContractAddresses[x]] = ActiveStates[x];
        }
        emit ContractInstancesChanged(ProjectIDs, ContractAddresses, Names, ActiveStates);
    }

    /**
     * @dev Changes Contract Instances Active State
     */
    function __ChangeContractInstanceActiveState(address[] calldata ContractAddresses, bool[] calldata Values) external onlyOwner
    {
        require(ContractAddresses.length == Values.length, "CTZN: Arrays Must Be Equal Length");
        for(uint x; x < ContractAddresses.length; x++)
        {
            BRTContractActive[ContractAddresses[x]] = Values[x];
        }
        emit ContractsActiveStateChanged(ContractAddresses, Values);
    }

    /**
     * @dev Changes Contract Instances
     */
    function __ChangeBRTContractAddresses(uint[] calldata ProjectIDs, address[] calldata ContractAddresses) external onlyOwner
    {
        require(ProjectIDs.length == ContractAddresses.length, "CTZN: Arrays Must Be Of Equal Length");
        for(uint x; x < ContractAddresses.length; x++)
        {
            BRTContracts[x].ContractAddress = ContractAddresses[x];
        }
        emit ContractAddressesChanged(ProjectIDs, ContractAddresses);
    }

    /**
     * @dev Changes BRT Contract Names
     */
    function __ChangeBRTContractNames(uint[] calldata ProjectIDs, string[] calldata Names) external onlyOwner
    {
        require(ProjectIDs.length == Names.length, "CTZN: Arrays Must Be Of Equal Length");
        for(uint x; x < ProjectIDs.length; x++)
        {
            BRTContracts[x].Name = Names[x];
        }
        emit ContractNamesChanged(ProjectIDs, Names);
    }

    /**
     * @dev Changes Reward Rates For Project
     */
    function __ChangeRewardRates(uint ProjectID, uint[] calldata RewardIndexes, uint[] calldata RewardRates) external onlyOwner
    {
        IBRT(BRTContracts[ProjectID].ContractAddress).ModifyRewardRates(RewardIndexes, RewardRates);
        emit RewardRatesChanged(ProjectID, RewardIndexes, RewardRates);
    }

    /*-------------*/
    /*  MODIFIERS  */
    /*-------------*/

    modifier onlyBRTContract
    {
        require(BRTContractActive[msg.sender], "CTZN: Sender Is Not Authorized BRT Contract");
        _;
    }
}